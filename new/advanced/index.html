<!doctype html>
<html lang="en" class="h-100">

<head>
	<title>DLUX SPK Hosting</title>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<link rel="manifest" href="/manifest.webmanifest">
	<link rel="apple-touch-icon" href="/img/dlux-icon-192.png">
	<meta name="apple-mobile-web-app-status-bar-style" content="default">
	<meta name="apple-mobile-web-app-title" content="DLUX">
	<meta name="theme-color" content="#111222" />
	<link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
	<!-- Bootstrap -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
	<link href="/css/custom.css" rel="stylesheet" />
	<link href="/css/smde.css" rel="stylesheet" />
	<script src="https://cdn.jsdelivr.net/npm/@hiveio/hive-js/dist/hive.min.js"></script>
	<script src="https://kit.fontawesome.com/0f693ffc58.js" crossorigin="anonymous"></script>
	<script src="https://unpkg.com/marked@0.3.6"></script>
	<script src="https://unpkg.com/lodash@4.16.0"></script>
	<script type="text/javascript" src="/js/onlyhash.js"></script>
	<script src="/js/buffer.js"></script>
	<script src="/js/drag-drop.js"></script>
	<script type="module" src="/js/spkvue.js"></script>
</head>

<body class="container h-100 padme-t70 text-center text-white">
	<div id="app" @dragover.prevent @drop.prevent>
		<div>
			<nav-vue @login="account = $event;getTokenUser($event);getHiveUser($event)"
				@logout="account = '';removeUser()" @ack="removeOp($event)" @refresh="run($event)" :op="toSign"
				:lapi="lapi" />
		</div>
		<main role="main" class="p-3 flex-shrink-0">
			<section class="flex">
				<div id="one">
					<div class="flex-column mb-4 px-3">
						<div class="flex-row">
							<button @click="showWallet = !showWallet">{{showWallet ? 'Hide Wallet' : 'Show Wallet'}}</button>
							<div v-if="showWallet" role="tabpanel" class="tab-pane fade show " id="spk" aria-labelledby="spktab">
                                <div class="container">
                                    <div>
                                        <div class="d-flex align-items-center mt-4 mb-2">
                                            <div class="d-flex align-items-start">
                                                <h1 class="m-0">SPK</h1>
                                            </div>
                                            <div class="text-center small m-0 p-2 ms-2" v-bind:class="{'text-success': larynxbehind < 30,
                                                    'text-warning': larynxbehind >= 30,
                                                    'text-danger': larynxbehind > 100}"> <span
                                                    v-show="larynxbehind < 30">ONLINE - </span> <span
                                                    v-show="larynxbehind >= 30 && larynxbehind <=100">LAGGING
                                                    - </span> <span v-show="larynxbehind > 100">OFFLINE -
                                                </span> <span>{{larynxbehind}} Blocks behind HIVE</span>
                                            </div>
                                            <div id="userNode" class="ms-auto" if="isnode">
                                                <a class="dropdown btn btn-lg btn-outline-info"
                                                    data-bs-auto-close="outside" href="#" role="button"
                                                    id="settingsDropdownBtn" data-bs-toggle="dropdown"
                                                    aria-expanded="false">
                                                    Vote<i class="ms-2 fa-solid fa-person-booth"></i></a>
                                                <ul class="dropdown-menu dropdown-menu-dark p-4 text-white-50 text-left bg-black dropdown-menu-end"
                                                    aria-labelledby="settingsDropdownBtn" style="width: 300px">
                                                    <li>
                                                        <h6 class="dropdown-header text-center">
                                                            {{tokenGov.title}}
                                                        </h6>
                                                    </li>
                                                    <li>
                                                        <h4 class="text-center text-white-50">@{{account}}</h4>
                                                    </li>
                                                    <li>
                                                        <form name="nodeSettings" class="needs-validation" novalidate>
                                                            <div class="row mb-3" v-for="opt in tokenGov.options">
                                                                <label :for="opt.json"
                                                                    class="form-label d-flex">{{opt.title}}:
                                                                    <div
                                                                        class="dropdown show d-flex align-items-center p-0 m-0">
                                                                        <a class="text-white" href="#" role="button"
                                                                            data-bs-toggle="dropdown"
                                                                            aria-haspopup="true" aria-expanded="false">
                                                                            <h5 class="m-0"><i
                                                                                    class="fas fa-info-circle ms-2"></i>
                                                                            </h5>
                                                                        </a>
                                                                        <div
                                                                            class="dropdown-menu dropdown-menu-dark dropdown-menu-end p-4 text-white-50 text-left bg-black">
                                                                            <p>{{opt.info}}</p>
                                                                        </div>
                                                                    </div>
                                                                </label>
                                                                <div class="input-group">
                                                                    <input type="number" v-model="opt.val"
                                                                        class="form-control bg-darkg border-secondary text-info"
                                                                        :id="opt.id" :max="opt.range_high"
                                                                        :min="opt.range_low" :step="opt.step" />
                                                                    <span v-if="opt.unit"
                                                                        class="input-group-text bg-darkg border-secondary text-secondary">{{opt.unit}}</span>
                                                                </div>
                                                            </div>
                                                            <div class="text-center mt-3">
                                                                <button id="saveSettingsBtn" type="button"
                                                                    class="btn btn-primary mb-2"
                                                                    @click="saveNodeSettings()">
                                                                    Vote<i class="ms-2 fa-solid fa-check-to-slot"></i>
                                                                </button>
                                                                <p class="small">Your vote cannot be changed or
                                                                    cancelled once submitted.</p>
                                                            </div>
                                                            <div class="text-start">
                                                                <p class="lead mb-1 text-center">VOTE POWER (VP)</p>
                                                                <div class="progress mb-2" role="progressbar"
                                                                    aria-label="Vote Power" aria-valuenow="75"
                                                                    aria-valuemin="0" aria-valuemax="100">
                                                                    <div class="progress-bar" style="width: 75%">75%
                                                                    </div>
                                                                </div>
                                                                <ul class="small">
                                                                    <li>Voting will drain VP to 0%</li>
                                                                    <li>Recharge rate: 200,000 blocks</li>
                                                                    <li>Recharge rate: 14 days</li>

                                                                </ul>
                                                            </div>
                                                        </form>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="border-bottom border-secondary">
                                            <p class="lead">Decentralized and incentivized network infrastructure,
                                                rewarding
                                                providers with SPK governance and BROCA gas tokens.</p>
                                        </div>
                                        <!--spk token-->
                                        <div class="d-flex align-items-center border-bottom border-secondary py-5">
                                            <div>
                                                <div class="d-flex align-items-start">
                                                    <h4 class="m-0">SPK Token</h4>
                                                </div>
                                                <p class="text-white-50 m-0">The governance token for the SPK network.
                                                </p>
                                            </div>
                                            <div class="ms-auto text-end">
                                                <h5>
                                                    {{formatNumber((saccountapi.spk)/1000, 3, '.', ',')}}
                                                    SPK
                                                </h5>
                                                <div class="btn-group" role="group" aria-label="SPK Actions">
                                                    <button type="button" class="btn btn-info p-0">
                                                        <modal-vue type="send" token="SPK" :balance="saccountapi.spk"
                                                            :account="account" @modalsign="sendIt($event)">
                                                            <span slot="trigger" class="p-2"><i
                                                                    class="fas fa-paper-plane me-2"></i>Send</span>
                                                        </modal-vue>
                                                    </button>
                                                    <button type="button" class="btn btn-dark ms-0 me-0 ps-0 pe-0"
                                                        disabled></button>
                                                    <div class="btn-group" role="group" v-if="me">
                                                        <button type="button" class="btn btn-info dropdown-toggle"
                                                            data-bs-toggle="dropdown" aria-haspopup="true"
                                                            aria-expanded="false"></button>
                                                        <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end text-white"
                                                            aria-labelledby="btnGroupDrop1">
                                                            <modal-vue type="power" token="SPK" func="Power Up"
                                                                :balance="saccountapi.spk" :account="account"
                                                                @modalsign="sendIt($event)">
                                                                <button class="dropdown-item" slot="trigger"
                                                                    type="button"><i
                                                                        class="fas fa-angle-double-up fa-fw me-2"></i>Power
                                                                    Up</button>
                                                            </modal-vue>
                                                            <div class="dropdown-divider"></div>
                                                            <a class="dropdown-item" href="/dex/larynx" id="buylink"><i
                                                                    class="fas fa-coins fa-fw me-2"></i>Buy / Sell</a>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--claim larynx airdrop-->
                                        <div id="larynxclaimdiv"
                                            class="d-flex align-items-center border-bottom border-secondary py-5"
                                            v-if="parseInt(saccountapi.drop.last_claim, 16) != frmDate() && saccountapi.drop.availible.amount > 0 && me">
                                            <div>
                                                <div class="d-flex align-items-start">
                                                    <h4 class="m-0">LARYNX Airdrop Claim</h4>
                                                </div>
                                                <p class="text-white-50">This months claimable tokens based on a January
                                                    6th HIVE blockchain snapshot.</p>
                                                <p>Tokens not claimed do not roll over to next month.</p>
                                                <input type="text" name="frmDateReg" required id="frmDate" value=""
                                                    class="d-none">
                                            </div>
                                            <div id="claimlarynxbtn" class="ms-auto text-end">
                                                <h5>{{formatNumber((saccountapi.drop.availible.amount)/1000, 3, '.',
                                                    ',')}}
                                                    LARYNX</h5>
                                                <div class="btn-group" role="group" aria-label="LARYNX Claim">
                                                    <button type="submit" class="btn btn-info "
                                                        @click="dropClaim('spkcc', 'claim')"><i
                                                            class="fas fa-coin"></i><i
                                                            class="fas fa-money-bill-wave-alt me-2"></i>Claim</button>
                                                </div>
                                            </div>
                                        </div>
                                        <!--claim larynx rewards-->
                                        <div class="d-flex align-items-center border-bottom border-secondary py-5"
                                            id="larynxclaimrewards" v-if="saccountapi.claim > 0 && me">
                                            <div>
                                                <div class="d-flex align-items-start">
                                                    <h4 class="m-0">LARYNX Rewards Claim</h4>
                                                </div>
                                                <p class="text-white-50">Claimable rewards for running a SPK service
                                                    node.</p>
                                            </div>
                                            <div id="claimlarynxrewardbtn" class="ms-auto text-end">
                                                <h5>{{formatNumber((saccountapi.claim)/1000, 3, '.', ',')}} LARYNX
                                                </h5>
                                                <div class="mb-2"> <span class="small" v-show="!spk2gov">50% Liquid |
                                                        50%
                                                        Power</span> <span class="small" v-show="spk2gov">50%
                                                        Liquid | 50% Gov</span></div>
                                                <div v-show="accountapi.gov > 0" class="bg-dark text-white">
                                                    <div class="input-group my-3">
                                                        <span class="input-group-text bg-darkg border-info text-info">
                                                            <div class="form-check form-switch ">
                                                                <input class="form-check-input" type="checkbox"
                                                                    role="switch" id="flexSwitchCheckDefault"
                                                                    v-model="spk2gov">
                                                                <label class="form-check-label"
                                                                    for="flexSwitchCheckDefault">Claim GOV not
                                                                    PWR</label>
                                                            </div>
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="btn-group" role="group" aria-label="LARYNX Claim">
                                                    <button type="submit" class="btn btn-info "
                                                        @click="rewardClaim('spkcc', 'shares_claim', spk2gov)"><i
                                                            class="fas fa-coin"></i><i
                                                            class="fas fa-money-bill-wave-alt me-2"></i>Claim</button>
                                                </div>
                                            </div>
                                        </div>
                                        <!--larynx token-->
                                        <div class="d-flex align-items-center border-bottom border-secondary py-5">
                                            <div>
                                                <div class="d-flex align-items-start">
                                                    <h4 class="m-0">LARYNX Token</h4>
                                                </div>
                                                <p class="text-white-50">The mining token for the SPK network.</p>
                                            </div>
                                            <div class="ms-auto text-end">
                                                <h5>
                                                    {{formatNumber((saccountapi.balance)/1000, 3, '.', ',')}} LARYNX
                                                </h5>
                                                <div class="btn-group" role="group" aria-label="LARYNX Actions">
                                                    <button type="button" class="btn btn-info p-0">
                                                        <modal-vue type="send" token="LARYNX"
                                                            :balance="saccountapi.balance" :account="account"
                                                            @modalsign="sendIt($event)">
                                                            <span slot="trigger" class="p-2"><i
                                                                    class="fas fa-paper-plane me-2"></i>Send</span>
                                                        </modal-vue>
                                                    </button>
                                                    <button type="button" class="btn btn-dark ms-0 me-0 ps-0 pe-0"
                                                        disabled></button>
                                                    <div class="btn-group" role="group" v-if="me">
                                                        <button type="button" class="btn btn-info dropdown-toggle"
                                                            data-bs-toggle="dropdown" aria-haspopup="true"
                                                            aria-expanded="false"></button>
                                                        <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end text-white"
                                                            aria-labelledby="btnGroupDrop1">
                                                            <modal-vue type="power" token="LARYNX" func="Power Up"
                                                                :balance="saccountapi.balance" :account="account"
                                                                @modalsign="sendIt($event)">
                                                                <button class="dropdown-item" slot="trigger"
                                                                    type="button"><i
                                                                        class="fas fa-angle-double-up fa-fw me-2"></i>Power
                                                                    Up</button>
                                                            </modal-vue>
                                                            <modal-vue type="power" :dis="!isNode" token="LARYNX"
                                                                func="Lock Liquidity" :balance="saccountapi.balance"
                                                                :account="account" @modalsign="sendIt($event)">
                                                                <button class="dropdown-item" :disabled="!isNode"
                                                                    slot="trigger" type="button"><i
                                                                        class="fas fa-lock fa-fw me-2"></i>Lock
                                                                    Liquidity</button>
                                                            </modal-vue>
                                                            <div class="dropdown-divider"></div>
                                                            <a class="dropdown-item" href="/dex/larynx" id="buylink"><i
                                                                    class="fas fa-coins fa-fw me-2"></i>Buy / Sell</a>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--locked larynx-->
                                        <div class="d-flex align-items-center border-bottom border-secondary py-5"
                                            v-if="saccountapi.gov">
                                            <div>
                                                <div class="d-flex align-items-start">
                                                    <h4 class="m-0">LARYNX Locked</h4>
                                                </div>
                                                <p class="text-white-50">Locked tokens provide liquidity to the
                                                    network, aid in determining consensus,
                                                    and earn rewards for node runners</p>
                                                <p class="text-white-50">Benefits of LARYNX Locked:</p>
                                                <ul class="text-white-50">
                                                    <li>Proof of Stake Consensus</li>
                                                    <li>Collateral for DEX transactions</li>
                                                    <li>Instant Lock | 4 Week Unlock</li>
                                                    <li>Requires an operating LARYNX node</li>
                                                    <li>Earns {{toFixed(parseFloat(spkStats.spk_rate_lgov) *
                                                        100,3)}}%</li>
                                                </ul>
                                            </div>
                                            <div id="larynxgactions" class="ms-auto text-end" v-show="me">
                                                <div class="d-flex align-items-center mb-2">
                                                    <small class="ms-auto"><span
                                                            class="badge me-2 text-bg-success">{{toFixed(parseFloat(spkStats.spk_rate_lgov)
                                                            *
                                                            100,3)}}%</span></small>
                                                    <h5 id="govbalance" class="m-0">
                                                        {{formatNumber((saccountapi.gov)/1000, 3, '.', ',')}} LL
                                                    </h5>
                                                </div>
                                                <div class="btn-group" role="group" aria-label="LARYNX Actions">
                                                    <button onclick="location.href='/dex/#larynx'" type="button"
                                                        class="btn btn-info p-0">
                                                        <span class="p-2"><i
                                                                class="fa-solid fa-gear fa-fw me-2"></i>Options</span>
                                                    </button>
                                                    <button type="button" class="btn btn-dark ms-0 me-0 ps-0 pe-0"
                                                        disabled></button>
                                                    <div class="btn-group" role="group" v-if="me">
                                                        <button id="btnGroupDrop1" type="button"
                                                            class="btn btn-info dropdown-toggle"
                                                            data-bs-toggle="dropdown" aria-haspopup="true"
                                                            aria-expanded="false"></button>

                                                        <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end text-white"
                                                            aria-labelledby="btnGroupDrop1">
                                                            <modal-vue type="power" token="LARYNX"
                                                                func="Unlock Liquidity" :balance="saccountapi.gov"
                                                                :account="account" @modalsign="sendIt($event)">
                                                                <button class="dropdown-item" slot="trigger"
                                                                    type="button"><i
                                                                        class="fas fa-lock-open fa-fw me-2"></i>Unlock
                                                                    Liquidity</button>
                                                            </modal-vue>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--larynx power-->
                                        <div class=" border-bottom border-secondary py-5">
                                            <div class="d-flex align-items-center">
                                                <div>
                                                    <div class="d-flex align-items-start">
                                                        <h4 class="m-0">LARYNX Power</h4>
                                                        <!-- <small><span
                                                                class="badge ms-1 me-2 text-bg-warning">TEST</span></small> -->
                                                    </div>
                                                    <p class="text-white-50">Powered tokens used to mine SPK</p>
                                                    <p class="text-white-50">Benefits of LARYNX Power:</p>
                                                    <ul class="text-white-50">
                                                        <li>Earns SPK governance tokens</li>
                                                        <li>Instant Lock | 4 Week Unlock</li>
                                                        <li>Delegate to node service accounts to build consensus (DPoS)
                                                        </li>
                                                        <li>LARYNX POWER (LP) earns SPK tokens at
                                                            {{toFixed(parseFloat(spkStats.spk_rate_lpow) * 100,3)}}%
                                                        </li>
                                                        <li>Delegated LP (DLP) earns SPK tokens for both delegator and
                                                            delegatee at
                                                            {{toFixed(parseFloat(spkStats.spk_rate_ldel) * 100,3)}}%
                                                        </li>
                                                    </ul>
                                                </div>
                                                <div id="larynxgactions" class="ms-auto text-end">
                                                    <div class="d-flex align-items-center mb-2">
                                                        <small class="ms-auto"><span
                                                                class="badge me-2 text-bg-success">{{toFixed(parseFloat(spkStats.spk_rate_lpow)
                                                                * 100,3)}}%</span></small>
                                                        <h5 class="m-0">
                                                            {{formatNumber((saccountapi.poweredUp)/1000, 3, '.', ',')}}
                                                            LP
                                                        </h5>
                                                    </div>
                                                    <div class="mb-2">
                                                        <a v-if="saccountapi.granting.t || saccountapi.granted.t"
                                                            data-bs-toggle="collapse" id="delegationsbtn"
                                                            href="#delegationsspk" role="button" aria-expanded="false"
                                                            aria-controls="Show delegations"
                                                            class="text-white d-flex align-items-center "
                                                            style="text-decoration: none">
                                                            <small class="ms-auto"><span
                                                                    class="badge me-2 text-bg-success">{{toFixed(parseFloat(spkStats.spk_rate_ldel)
                                                                    * 100,3)}}%</span></small>
                                                            <h5 class="m-0">
                                                                {{formatNumber((saccountapi.granting.t+saccountapi.granted.t)/1000,
                                                                3, '.', ',')}}
                                                                DLP<i class="fas fa-search ms-2"></i>
                                                            </h5>
                                                        </a>
                                                    </div>
                                                    <a v-if="saccountapi.granting.t || saccountapi.granted.t"
                                                        data-bs-toggle="collapse" id="delegationsbtn"
                                                        href="#delegationsspk" role="button" aria-expanded="false"
                                                        aria-controls="Show delegations" class="text-white d-none"
                                                        style="text-decoration: none">
                                                        <h6 id="delegatebal">
                                                            <span
                                                                v-if="saccountapi.granting.t">(-{{formatNumber((saccountapi.granting.t)/1000,
                                                                3,
                                                                '.', ',')}} LP)</span>
                                                            <span
                                                                v-if="saccountapi.granted.t">(+{{formatNumber((saccountapi.granted.t)/1000,
                                                                3,'.', ',')}} LP)</span>
                                                            <i class="fas fa-search ms-2"></i>
                                                        </h6>

                                                    </a>

                                                    <div class="btn-group" role="group" aria-label="LARYNX Actions">
                                                        <button class="btn btn-info p-0" type="button">
                                                            <modal-vue type="delegate" :smarkets="smarkets.node"
                                                                token="LARYNX" func="Lock Liquidity" :stats="sstats"
                                                                :balance="saccountapi.poweredUp" :account="account"
                                                                @modalsign="sendIt($event)"><span slot="trigger"
                                                                    class="p-2">
                                                                    <i
                                                                        class="fas fa-user-friends fa-fw me-2"></i>Delegate</span>
                                                            </modal-vue>
                                                        </button>
                                                        <button type="button" class="btn btn-dark ms-0 me-0 ps-0 pe-0"
                                                            disabled></button>
                                                        <div class="btn-group" role="group" v-if="me">
                                                            <button id="btnGroupDrop1" type="button"
                                                                class="btn btn-info dropdown-toggle"
                                                                data-bs-toggle="dropdown" aria-haspopup="true"
                                                                aria-expanded="false"></button>

                                                            <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end text-white"
                                                                aria-labelledby="btnGroupDrop1">
                                                                <modal-vue type="power" token="LARYNX" func="Power Down"
                                                                    :balance="saccountapi.poweredUp" :account="account"
                                                                    @modalsign="sendIt($event)">
                                                                    <button :disabled="!saccountapi.poweredUp"
                                                                        class="dropdown-item" slot="trigger"
                                                                        type="button"><i
                                                                            class="fas fa-angle-double-down fa-fw me-2"></i>Power
                                                                        Down</button>
                                                                </modal-vue>
                                                                <modal-vue v-show="when(saccountapi.powerDowns)"
                                                                    type="confirm" token="LARYNX" func="powercancel"
                                                                    :account="account" @modalsign="sendIt($event)">
                                                                    <button class="dropdown-item" slot="trigger"
                                                                        type="button">
                                                                        <i
                                                                            class="fa-solid fa-xmark fa-fw me-2"></i>Cancel
                                                                        Power Down</button>
                                                                </modal-vue>

                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div
                                                :class="{'d-none': !when(saccountapi.powerDowns), 'd-flex': true, 'align-items-center': true}">
                                                <b>A power down is scheduled
                                                    to happen in {{when(saccountapi.powerDowns)}}
                                                    ({{saccountapi.powerDowns.length}} installments remaining)</b><small
                                                    class="ms-2">
                                                    <modal-vue type="confirm" token="LARYNX" func="powercancel"
                                                        :account="account" @modalsign="sendIt($event)">
                                                        <button class="btn btn-sm btn-outline-danger" slot="trigger"
                                                            type="button">
                                                            STOP</button>
                                                    </modal-vue>
                                                </small>
                                            </div>
                                            <div class="collapse" id="delegationsspk">
                                                <div
                                                    class="d-flex flex-column text-start border border-secondary rounded p-4 my-4">
                                                    <h4 class="border-bottom border-secondary py-2">Delegated:
                                                        {{formatNumber((saccountapi.granting.t)/1000, 3,
                                                        '.', ',')}} LP</h4>
                                                    <div v-for="(a,b,c) in saccountapi.granting">
                                                        <div class="d-flex align-items-center border-bottom border-secondary pb-2 my-1"
                                                            v-if="b != 't'">
                                                            <p class="my-0">@{{b}}:
                                                                {{formatNumber((a)/1000, 3, '.', ',')}}
                                                                LP
                                                            </p>
                                                            <div class="d-flex ms-auto ">
                                                                <modal-vue type="delegate" :smarkets="smarkets.node"
                                                                    token="LARYNX" :to="b" :amount="a" :stats="sstats"
                                                                    :balance="saccountapi.poweredUp" :account="account"
                                                                    @modalsign="sendIt($event)">
                                                                    <button slot="trigger" type="button"
                                                                        class="ms-1 btn btn-secondary"><i
                                                                            class="fas fa-fw fa-user-edit"></i></button>
                                                                </modal-vue>
                                                                <modal-vue type="delegate" :smarkets="smarkets.node"
                                                                    token="LARYNX" :to="b" amount="0" :stats="sstats"
                                                                    :balance="saccountapi.poweredUp" :account="account"
                                                                    @modalsign="sendIt($event)">
                                                                    <button class="ms-1 btn btn-danger ms-1"
                                                                        slot="trigger" type="button"><i
                                                                            class="fas fa-fw fa-trash-alt"></i></button>
                                                                </modal-vue>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <h4 class="border-bottom border-secondary py-2 mt-5">
                                                        Received: {{formatNumber((saccountapi.granted.t)/1000,
                                                        3,'.', ',')}} LP</h4>
                                                    <div v-for="(a,b,c) in saccountapi.granted">
                                                        <div class="d-flex align-items-center border-bottom border-secondary pb-2 my-1"
                                                            v-if="b != 't'">
                                                            <p class="my-0">@{{b}}:
                                                                {{formatNumber((a)/1000, 3, '.', ',')}}
                                                                LP
                                                            </p>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!--account value-->
                                        <div class="d-flex align-items-center border-bottom border-secondary py-5">
                                            <div class="">
                                                <h4>Estimated Account Value</h4>
                                                <p class="text-white-50">The approximate US Dollar value for all SPK
                                                    assets
                                                    in your account</p>
                                            </div>
                                            <div class="ms-auto text-end">
                                                <h5 id="totallarynx">
                                                    ${{toFixed(spkval * saccountapi.tick * hiveprice.hive.usd,2)}}
                                                </h5>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
							<button v-if="showWallet" @click="showWallet = !showWallet">{{showWallet ? 'Hide Wallet' : 'Show Wallet'}}</button>
							<!-- <h1 class="px-4 font-weight-bold">DLUX</h1> -->
							<h1 class="px-4 font-weight-bold" style="font-variant:small-caps;">File Hosting
							</h1>
							<p class="lead">Upload your assets here, and select an available SPK hosting contract to pin
								your files on IPFS.</p>

							<hr class="bg-light">
						</div>
						<div class="mt-2">
							<!-- Make a form to get a contract -->
							<form>
								<div class="input-group">

									<span
										class="input-group-text bg-darkg border-secondary text-white-50 l-radius-hotfix">@</span>

									<input type="text" class="form-control bg-darkg border-secondary text-info" readonly
										id="username" v-model="account">
								</div>
								<div v-if="saccountapi.pubKey == 'NA'">
									<button @click="updatePubkey">
										Register Account
										<i class="fas fa-plus"></i>
									</button>
								</div>
								<div v-if="saccountapi.pubKey != 'NA'">
									<button>
										Get Test Contract
										<i class="fas fa-plus"></i>
									</button>
								</div>
							</form>
							<ul class="text-start">
								<li>Files:
									<ul>
										<li>QmZdEnRooHj4fN3RVYSeWQjPvMNUryQsJGcPHydoqWYRQQ</li>
										<li>100 Bytes</li>
										<li>- Ready to upload</li>
									</ul>
								<li>Size Allowed: 10Gb</li>
								<li>Size: 100 Bytes</li>
								<li>File Owner: @disregardfiat</li>
								<li>Sig: 'ikswdjfbkWIJHVGBFLWEg'</li>
								<li>Service_provider: @dlux-io</li>
								<li>Service Proivider Sig: 'jdasFVKJSWADHFBVLAKGBHF'</li>
								<li>Sponsor: @3spk</li>
								<li>Expiration: June 24th 14:00 UTC</li>
								<li>Price: 1000 Broca</li>
								<li>Contract ID: R4nD0</li>
								<li>Status: Waiting for Upload | Waiting for distributed storage</li>
								<li>Not Pinned</li>
								<li>Pinned By:
									<ul>
										<li>@darby</li>
										<li>@doofus</li>
										<li> ... pending</li>
									</ul>
								</li>
								<li>No Flags</li>
							</ul>
							<!-- <form>
								<ul class="text-center ms-auto me-auto col-md-8 col-lg-6 col-xl-4">
									<h3><u>Contract Types</u></h3>
									<li class="text-start">Direct: you pay for hosting now</li>
									<li class="text-start">Sponsored: free hosting with beneficiary
										fee</li>
								</ul>
								<div class="col-md-6 ms-auto me-auto">

									<div class="form-group mb-3">
										<div class="d-flex align-items-center mb-3">
											<label for="username">Client</label>
											<div class="ms-auto" style="visibility: hidden;">
												<div class="btn-group"><input type="radio" name="" id=""
														autocomplete="off" checked="checked" class="btn-check">
													<label for="" class="btn btn-outline-warning">
														SIMPLE
													</label> <input type="radio" name="" id="" autocomplete="off"
														class="btn-check"> <label for=""
														class="btn btn-outline-warning">
														SPONSORED
													</label>
												</div>
											</div>
										</div>
										<div class="input-group">

											<span
												class="input-group-text bg-darkg border-secondary text-white-50 l-radius-hotfix">@</span>

											<input type="text" class="form-control bg-darkg border-secondary text-info"
												readonly id="username" v-model="account">
										</div>
									</div>

									<div class="form-group mb-3">
										<div class="d-flex align-items-center mb-3">
											<label for="title">Provider</label>
											<div class="ms-auto">
												<div class="btn-group"><input type="radio" name="contractType"
														@click="simple.checked = true; sponsored.checked = false"
														id="simple" autocomplete="off" checked="checked"
														class="btn-check" :checked="simple.checked"> <label for="simple"
														class="btn btn-outline-warning">
														DIRECT
													</label> <input type="radio" name="contractType" id="sponsored"
														@click="simple.checked = false; sponsored.checked = true"
														autocomplete="off" class="btn-check"
														:checked="sponsored.checked"> <label for="sponsored"
														class="btn btn-outline-warning">
														SPONSORED
													</label>
												</div>
											</div>
										</div>
										<div v-show="simple.checked">
											<input class="form-control bg-darkg border-secondary text-info"
												list="datalistOptions1" id="simpleContracts"
												placeholder="Type to search direct contracts...">
											<datalist id="datalistOptions1">
												<option value="High"></option>
												<option value="Average"></option>
												<option value="Low"></option>
												<option value="Custom"></option>
											</datalist>
										</div>
										<div v-show="sponsored.checked">
											<input class="form-control bg-darkg border-secondary text-info"
												list="datalistOptions2" id="sponsoredContracts"
												placeholder="Type to search sponsored contracts...">
											<datalist id="datalistOptions2">
												<option value="threespk.voter"></option>
												<option value="dlux-io"></option>
												<option value="someguy321"></option>
												<option value="daffy"></option>
												<option value="dolly"></option>
											</datalist>
										</div>
									</div>


									<div>
										<h5>Contract: {{contract.id}}</h5>
										<p class="text-start text-white-50 small">@threespk.voter is placing 1000 BROCA to store up to 10GB of data. You must make a post on the hive blockchain with 10% beneficiary to @threespk.voter with-in 24 hours for this storage contract to be inforce. </p>
									</div>
								</div>
							</form> -->
						</div>
					</div>
				</div>
				<div id="two">
					<div class="flex-column flex-shrink mx-3">
						<div style="border-style:solid;">
							<form>
								<input id="fileInput" type="file" @change="uploadFile" multiple />
								<div style="background-color:green;margin-bottom:10px;padding:10px;" id="img-well"
									@drop="dragFile($event)">
									Or drag the file here
								</div>
							</form>
							<div v-if="File.length">
								<button @click="signNUpload()">Sign and Upload</button>
							</div>
						</div>
						<div id="listOfImgs" v-for="file in File">
							<div class="p-3 mb-3 bg-dark" style="border-radius: 10px;">
								<div class="d-flex align-items-center flex-row pb-2 mb-2"
									style="border-bottom-style: solid; border-bottom-color: #909090">
									<div class="d-flex">
										<h6>{{file.name}}</h6>
									</div>
									<div class="ml-auto"><button type="button" @click="togglePin(index)"
											class="btn ${btnclass} btn-sm mr-2" data-toggle="tooltip"
											data-placement="top" title="Asset Pinned to IPFS"><i
												class="fas fa-fw fa-thumbtack"></i></button><button
											class="btn btn-danger btn-sm" @click="deleteImg(index)"
											data-toggle="tooltip" data-placement="top" title="Delete Asset"><i
												class="fas fa-fw fa-trash-alt"></i></button></div>
								</div>
								<div class="d-flex flex-row">
									<div>
										<div class="small">
											<ul>
												<li>Bytes: {{file.size}}</li>
												<li>CID: {{FileInfo[file.name].hash}}</li>
												<li>
													<div class="progress" role="progressbar"
														aria-label="Example with label" aria-valuenow="25"
														aria-valuemin="0" aria-valuemax="100">
														<div class="progress-bar"
															:style="'width: ' + FileInfo[file.name].progress + '%'">
															{{file.progress}}%</div>
													</div>
												</li>
											</ul>
										</div>
									</div>
									<div v-if="FileInfo[file.name].uploaded">
										<div><img :src="'https://ipfs.dlux.io/ipfs/' + FileInfo[file.name].hash"
												width="100%" /></div>
										<div class="small"><a
												:href="'https://ipfs.dlux.io/ipfs/' + FileInfo[file.name].hash"
												target="_blank">https://ipfs.io/ipfs/{{FileInfo[file.name].hash}}</a>
										</div>
									</div>
									<div v-if="File.length">
										<button v-if="file.actions.pause"
											@click="fileRequest[file.index].resumeFileUpload()">Pause</button>
										<button v-if="file.actions.resume"
											@click="fileRequest[file.index].resumeFileUpload()">Resume</button>
										<button v-if="file.actions.cancel"
											@click="fileRequest[file.index].resumeFileUpload()">Cancel</button>
										<h5>{{FileInfo[file.name].status}}</h5>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</section>
		</main>
	</div>
	<script src="/js/img-ipfs.js"></script>

	<script>
		// Example starter JavaScript for disabling form submissions if there are invalid fields
		(function () {
			"use strict";
			window.addEventListener(
				"load",
				function () {
					// Fetch all the forms we want to apply custom Bootstrap validation styles to
					var forms = document.getElementsByClassName("needs-validation");
					// Loop over them and prevent submission
					var validation = Array.prototype.filter.call(forms, function (form) {
						form.addEventListener(
							"submit",
							function (event) {
								console.log("button");
								if (
									document.getElementById("validationCustomDescription")
										.innerHTML == "Sign In"
								) {
									sendLink("/auth");
								}
								var tagField = document.getElementById(
									"validationCustomReferal"
								).value;
								var tags = tagField.split(",").map(item => item.trim());
								let otherTags = tags.slice(0, 4);
								var customJSON = JSON.stringify({
									tags: otherTags,
									subApp: "SuperCraftLoader/v0.1",
									xr: false,
									vrHash: "QmTzKnzxEm3ZXcqFMxytt3fnJZvSSvtRnMCZTuzzMxwG7y",
									superCraft: document.getElementById(
										"validationCustomLoader"
									).value
								});
								var postData = {
									title: document.getElementById("validationCustomTitle")
										.value,
									message: document.getElementById(
										"validationCustomDescription"
									).value,
									customJSON: customJSON
								};
								console.log(postData);
								if (form.checkValidity() === false) {
									event.preventDefault();
									event.stopPropagation();
								} else {
									window.parent.postMessage(
										{
											func: "advPost",
											message: postData
										},
										"*"
									);
								}
								form.classList.add("was-validated");
							},
							false
						);
					});
				},
				false
			);
		})();
      //onpageloaded();
	</script>
	<script>

		var custom_json = {
			"app": "dlux/0.0.9",
			"xr": true,
			"Hash360": "",
			"format": "markdown",
			"assets": [
			],
			"tags": [
				"dlux"
			],
			"vrHash": "QmNby3SMAAa9hBVHvdkKvvTqs7ssK4nYa2jBdZkxqmRc16"
		},
			permlink
		function saveToIpfs(ar, pin, is360, newAsset) {
			console.log(`You've requested to upload and pin(${pin}) 360(${is360}) image(s) and create assets(${newAsset})\nIPFS maky take some time to upload...`)
			var ipfsIP = []
			var info = []
			for (var name in ar) {
				ipfsIP.push({ 'path': `${ar[name][1]}`, 'content': ar[name][0] })
				info.push([name, ar[name][1]])
			}
			ipfs.add(ipfsIP, (err, ipfsReturn) => {
				if (!err) {
					iloaded(ipfsReturn, info)
				} else {
					console.log('IPFS Upload Failed', err)
				}
			})
		}
		function iloaded(assets, info) {
			if (assets) {
				for (var i = 0; i < assets.length; i++) {
					custom_json.assets.push({
						hash: assets[i].hash,
						name: assets[i].path,
						size: assets[i].size,
						pin: true,
						type: "ts",
						thumbHash: assets[i].hash
					})
					if (!custom_json.Hash360) {
						custom_json.Hash360 = assets[i].hash
					}
				}
			}
			hive.api.getContent('markegiles', 'dlux-vr-tutorial-sm-test', function (err, result) {
				result.json_metadata = JSON.stringify(custom_json)
				var target = document.getElementById('aframePreview').contentWindow
				var un = 'Guest'
				if (localStorage.getItem('user')) { un = localStorage.getItem('user') }
				target.postMessage({
					'func': 'iAm',
					'message': un,
				}, "*");
				target.postMessage({
					'func': 'key',
					'message': 'markegiles/dlux-vr-tutorial-sm-test',
				}, "*");
				target.postMessage({
					'func': 'hiveState',
					'message': result,
				}, "*");
			})
			buildList()
		}
		function buildList() {
			document.getElementById('listOfImgs').innerHTML = ``
			for (var i = 0; i < custom_json.assets.length; i++) {
				const img = custom_json.assets[i]
				if (img.type == 'ts') {
					var btnclass = 'btn-primary'
					if (!img.pin) {
						btnclass = 'btn-outline-primary'
					}
					var item = document.createElement('div')
					item.id = `item${i}`
					item.class = `p-3 mb-3 bg-dark`
					item.setAttribute('style', 'border-radius', '10px')
					item.innerHTML = `
				<div id="image${i}" class="p-3 mb-3 bg-dark" style="border-radius: 10px;">
				<div class="d-flex align-items-center flex-row pb-2 mb-2" style="border-bottom-style: solid; border-bottom-color: #909090">
					<div class="d-flex"><input id="nameOf${img.hash}" class="form-control form-control-sm mr-2" type="text" value="${img.name}" disabled><button onclick="toggleNameEdit('${img.hash}')" class="btn btn-secondary btn-sm ml-auto" data-toggle="tooltip" data-placement="top" title="Edit Name"><i id="editName${img.hash}" class="fas fa-fw fa-pencil-alt"></i></button></div>
					<div class="ml-auto"><button type="button" onclick="togglePin('${img.hash}')" class="btn ${btnclass} btn-sm mr-2" data-toggle="tooltip" data-placement="top" title="Asset Pinned to IPFS"><i class="fas fa-fw fa-thumbtack"></i></button><button class="btn btn-danger btn-sm" onclick="deleteImg('${img.hash}')" data-toggle="tooltip" data-placement="top" title="Delete Asset"><i class="fas fa-fw fa-trash-alt"></i></button></div>
				</div>
				<div class="d-flex flex-row">
		  		<div id="source${i}">
					<div><img id="sImg${i}" src="https://ipfs.io/ipfs/${img.hash}" width="100%"/></div>
					<div class="small"><a href="https://ipfs.io/ipfs/${img.hash}" id="sHashImg${i}" target="_blank">https://ipfs.io/ipfs/${img.hash}</a></div>
		  		</div>
			</div>
				`
					document.getElementById('listOfImgs').appendChild(item)
				}
			}
		}
		function togglePin(hash) {
			for (var i = 0; i < custom_json.assets.length; i++) {
				const img = custom_json.assets[i]
				if (img.hash == hash) {
					if (img.pin) { custom_json.assets[i].pin = false }
					else { custom_json.assets[i].pin = true }
				}
			}
			buildList()
		}
		function deleteImg(hash) {
			for (var i = 0; i < custom_json.assets.length; i++) {
				const img = custom_json.assets[i]
				if (img.hash == hash) {
					custom_json.assets.splice(i, 1)
				}
			}
			//buildList ()
			iloaded()
		}
		function toggleNameEdit(hash) {
			var enabled = document.getElementById(`nameOf${hash}`).disabled
			document.getElementById(`nameOf${hash}`).disabled = !enabled
			document.getElementById(`editName${hash}`).setAttribute('class', 'fas fa-fw fa-check')
			console.log(enabled)
			if (!enabled) {
				//document.getElementById(`editName${hash}`).addClass('fa-pencil-alt')
				//document.getElementById(`editName${hash}`).removeClass('fa-check')
				for (var i = 0; i < custom_json.assets.length; i++) {
					const img = custom_json.assets[i]
					if (img.hash == hash) {
						custom_json.assets[i].name = document.getElementById(`nameOf${hash}`).value
						break;
					}
				}
				//buildList()
				iloaded()
			}
		}

		function post() {
			const operations = [["comment",
				{
					"parent_author": "",
					"parent_permlink": "dlux",
					"author": localStorage.getItem('user'),
					"permlink": permlink,
					"title": document.getElementById('title').value,
					"body": simplemde.value() + `\n***\n#### [View in VR @ dlux.io](https://dlux.io/dlux/@${localStorage.getItem('user')}/${permlink})\n`,
					"json_metadata": JSON.stringify(custom_json)
				}],
			["comment_options",
				{
					"author": localStorage.getItem('user'),
					"permlink": permlink,
					"max_accepted_payout": "1000000.000 HBD",
					"percent_hbd": 10000,
					"allow_votes": true,
					"allow_curation_rewards": true,
					"extensions":
						[[0,
							{
								"beneficiaries":
									[{
										"account": "dlux-io",
										"weight": 1000
									}]
							}]]
				}]]
			hive_keychain.requestBroadcast(localStorage.getItem('user'), operations, 'active', function (response) {
				console.log(response);
			});

		}
	</script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
		crossorigin="anonymous"></script>
</body>

</html>